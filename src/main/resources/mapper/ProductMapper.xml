<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.devkurly.product.dao.ProductMapper">
    <select id="select" parameterType="int" resultType="Product">
        select pdt_id,
               cat_code,
               price,
               ds_rate,
               sel_price,
               title,
               sub_title,
               rec_info,
               adt_sts,
               stock,
               in_date,
               in_user,
               up_date,
               up_user
        from PRODUCT_TB
        where pdt_id =#{pdt_id}
    </select>

    <select id="count" resultType="int">
        SELECT count(*) FROM PRODUCT_TB
    </select>

    <delete id="deleteAll">
        DELETE FROM PRODUCT_TB
    </delete>

    <!-- 관리자 권한으로 삭제 매퍼 delete id="deleteForAdmin">
        DELETE FROM PRODUCT_TB WHERE pdt_id = #{pdt_id}
    </delete-->

    <delete id="delete" parameterType="map">
        DELETE FROM PRODUCT_TB WHERE pdt_id = #{pdt_id}
    </delete>

    <insert id="insert" parameterType="Product">
        INSERT INTO PRODUCT_TB
        (pdt_id, title, ds_rate, sel_price, price, sub_title)
        VALUES
            (#{pdt_id},#{price},#{ds_rate},#{sel_price}, #{title}, #{sub_title})
    </insert>

    <select id="ProductNewList" parameterType="map" resultType="Product">
        select pdt_id,
               cat_code,
               price,
               image,
               ds_rate,
               sel_price,
               title,
               sub_title,
               rec_info,
               adt_sts,
               stock,
               in_date,
               in_user,
               up_date,
               up_user
        from PRODUCT_TB
        ORDER BY in_date ASC, up_date DESC
    </select>


    <select id="ProductThriftylist" parameterType="map" resultType="Product">
        select pdt_id,
               cat_code,
               price,
               image,
               ds_rate,
               sel_price,
               title,
               sub_title,
               rec_info,
               adt_sts,
               stock,
               in_date,
               in_user,
               up_date,
               up_user
        from PRODUCT_TB
        ORDER BY in_date ASC, up_date DESC
    </select>

    <select id="ProductList" resultType="Product">
        Select TG.tag_name,P.title,P.sub_title,P.ds_rate,P.price,P.sel_price,P.pdt_id,P.sales_rate,D.de_type,D.company,P.stock
        FROM PRODUCT_TB P
                 RIGHT OUTER JOIN PRODUCT_DETAIL_TB D
                                  ON D.pdt_id = P.pdt_id
                 RIGHT OUTER JOIN PRODUCT_TAG_TB T
                                  ON T.pdt_id = P.pdt_id
                 RIGHT OUTER JOIN TAG_TB TG
                                  ON TG.tag_id = T.tag_id
        ORDER BY  pdt_id ASC
    </select>

<!--   <select id="ProductListAsc" parameterType="map" resultType="Product">-->
<!--       Select P.pdt_id,P.price,P.ds_rate,P.sel_price,P.title,P.sub_title,P.sales_rate,D.de_type,P.sales_rate,P.stock-->
<!--       FROM PRODUCT_TB P-->
<!--                 RIGHT OUTER JOIN PRODUCT_DETAIL_TB D-->
<!--                                 ON D.pdt_id = P.pdt_id-->
<!--       ORDER BY #{order_sc} ASC-->
<!--   </select>-->

    <select id="ProductListDESC" parameterType="map" resultType="Product">
        Select TG.tag_name,P.title,P.sub_title,P.ds_rate,P.price,P.sel_price,P.pdt_id,P.sales_rate,D.de_type,D.company,P.stock
        FROM PRODUCT_TB P
                 RIGHT OUTER JOIN PRODUCT_DETAIL_TB D
                                  ON D.pdt_id = P.pdt_id
                 RIGHT OUTER JOIN PRODUCT_TAG_TB T
                                  ON T.pdt_id = P.pdt_id
                 RIGHT OUTER JOIN TAG_TB TG
                                  ON TG.tag_id = T.tag_id
        ORDER BY ${order_sc} DESC , ${order_Asc} ASC
    </select>

    <select id="ProductBestlist" parameterType="map" resultType="Product">
        select pdt_id,
               cat_code,
               price,
               image,
               ds_rate,
               sel_price,
               title,
               sub_title,
               rec_info,
               adt_sts,
               stock,
               in_date,
               in_user,
               up_date,
               up_user
        from PRODUCT_TB
        ORDER BY in_date ASC, up_date DESC
    </select>

    <sql id="selectFromProduct">
        select pdt_id,
               cat_code,
               price,
               ds_rate,
               sel_price,
               title,
               sub_title,
               rec_info,
               adt_sts,
               stock,
               in_date,
               in_user,
               up_date,
               up_user
            FROM PRODUCT_TB
    </sql>

    <update id="update" parameterType="Product">
        UPDATE PRODUCT_TB
        SET   price = #{price},
              ds_rate = #{ds_rate},
              sel_price =#{sel_price},
              title = #{title},
              sub_title = #{sub_title},
              up_date = now()
        WHERE pdt_id = #{pdt_id}
        ORDER BY title DESC
    </update>
</mapper>
